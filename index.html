<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Cotizador de Muebles</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #ffffff;
    --surface: #ffffff;
    --surface2: #f4f5f8;
    --border: #e2e5ed;
    --accent: #d4a000;
    --accent2: #0a9e6a;
    --danger: #e03040;
    --text: #1a1e2e;
    --muted: #6b7794;
    --font-head: 'Syne', sans-serif;
    --font-mono: 'DM Mono', monospace;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font-mono);
    min-height: 100vh;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(0,0,0,0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,0,0,0.04) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .wrapper {
    position: relative;
    z-index: 1;
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 24px 80px;
  }

  header {
    margin-bottom: 32px;
    padding-bottom: 24px;
    border-bottom: 1px solid var(--border);
  }

  .logo-area h1 {
    font-family: var(--font-head);
    font-size: 2.6rem;
    font-weight: 800;
    letter-spacing: -2px;
    line-height: 1;
  }

  .logo-area h1 .accent { color: var(--accent); }

  .logo-area p {
    color: var(--muted);
    font-size: 0.75rem;
    margin-top: 6px;
    letter-spacing: 3px;
    text-transform: uppercase;
  }

  .toolbar {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
    align-items: center;
  }

  .btn {
    font-family: var(--font-head);
    font-size: 0.8rem;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    padding: 10px 20px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    transition: all 0.15s;
    display: flex;
    align-items: center;
    gap: 7px;
  }

  .btn:active { transform: scale(0.97); }
  .btn-primary { background: var(--accent); color: #fff; }
  .btn-primary:hover { background: #e8b800; }
  .btn-danger { background: transparent; color: var(--danger); border: 1px solid var(--danger); }
  .btn-danger:hover { background: rgba(224,48,64,0.08); }
  .spacer { flex: 1; }

  .table-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
  }

  table { width: 100%; border-collapse: collapse; }

  thead tr { background: var(--surface2); border-bottom: 1px solid var(--border); }

  thead th {
    padding: 13px 14px;
    font-size: 0.65rem;
    color: var(--muted);
    letter-spacing: 2px;
    text-transform: uppercase;
    font-weight: 500;
    font-family: var(--font-mono);
    text-align: left;
  }

  thead th.center { text-align: center; }
  thead th.right  { text-align: right; }

  tbody tr {
    border-bottom: 1px solid var(--border);
    transition: background 0.15s;
    animation: rowIn 0.3s ease both;
  }

  @keyframes rowIn {
    from { opacity: 0; transform: translateX(-6px); }
    to   { opacity: 1; transform: translateX(0); }
  }

  tbody tr:hover { background: rgba(212,160,0,0.04); }
  tbody tr:last-child { border-bottom: none; }

  td { padding: 10px 14px; vertical-align: middle; }

  td input[type="text"],
  td input[type="number"] {
    background: #f9fafc;
    border: 1px solid var(--border);
    color: var(--text);
    font-family: var(--font-mono);
    font-size: 0.85rem;
    padding: 8px 10px;
    border-radius: 4px;
    width: 100%;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  td input:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px rgba(212,160,0,0.12);
  }

  td input[readonly] {
    background: transparent;
    border-color: transparent;
    color: var(--accent2);
    cursor: default;
    font-weight: 500;
  }

  td select {
    background: #f9fafc;
    border: 1px solid var(--border);
    color: var(--text);
    font-family: var(--font-mono);
    font-size: 0.85rem;
    padding: 8px 10px;
    border-radius: 4px;
    width: 100%;
    outline: none;
    transition: border-color 0.2s;
    cursor: pointer;
    -webkit-appearance: none;
  }

  td select:focus { border-color: var(--accent); }

  .td-num { text-align: right; font-variant-numeric: tabular-nums; }
  .td-center { text-align: center; }

  .row-num {
    font-size: 0.75rem;
    color: var(--muted);
    font-weight: 500;
    text-align: center;
    display: block;
  }

  .btn-del-row {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--muted);
    font-size: 0.75rem;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-family: var(--font-mono);
    transition: all 0.15s;
    white-space: nowrap;
  }

  .btn-del-row:hover {
    border-color: var(--danger);
    color: var(--danger);
    background: rgba(224,48,64,0.06);
  }

  tfoot td {
    padding: 16px 14px;
    background: var(--surface2);
    border-top: 2px solid var(--border);
  }

  .footer-label {
    font-family: var(--font-head);
    font-size: 0.75rem;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--muted);
  }

  .footer-total {
    font-family: var(--font-head);
    font-size: 1.5rem;
    font-weight: 800;
    color: var(--accent);
    text-align: right;
    letter-spacing: -0.5px;
  }

  .empty-state {
    text-align: center;
    padding: 50px 20px;
    color: var(--muted);
    font-size: 0.85rem;
    letter-spacing: 1px;
  }

  .empty-state span { font-size: 2.5rem; display: block; margin-bottom: 10px; opacity: 0.4; }

  .toast {
    position: fixed;
    bottom: 28px; right: 28px;
    padding: 12px 22px;
    border-radius: 5px;
    font-family: var(--font-head);
    font-weight: 700;
    font-size: 0.85rem;
    opacity: 0;
    transform: translateY(8px);
    transition: opacity 0.25s, transform 0.25s;
    pointer-events: none;
    z-index: 999;
  }

  .toast.success { background: var(--accent2); color: #fff; }
  .toast.info    { background: var(--text); color: #fff; }
  .toast.show    { opacity: 1; transform: translateY(0); }

  @media (max-width: 600px) {
    .logo-area h1 { font-size: 1.8rem; }
  }
</style>
</head>
<body>
<div class="wrapper">

  <header>
    <div class="logo-area">
      <h1>COTIZADOR DE <span class="accent">MUEBLES</span></h1>
      <p>Gesti√≥n de presupuestos</p>
    </div>
  </header>

  <div class="toolbar">
    <button class="btn btn-primary" onclick="addRow()">+ Nueva fila</button>
    <div class="spacer"></div>
    <button class="btn btn-danger" onclick="resetTable()">‚Ü∫ Reiniciar</button>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th class="center">#</th>
          <th>Material / Mueble</th>
          <th class="right">Valor unitario</th>
          <th class="center">Cantidad</th>
          <th class="right">Total</th>
          <th class="center">Acci√≥n</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
      <tfoot id="tfoot">
        <tr>
          <td colspan="4" class="footer-label">TOTAL GENERAL</td>
          <td class="footer-total" id="f-total">$0</td>
          <td></td>
        </tr>
      </tfoot>
    </table>
    <div id="empty-state" class="empty-state" style="display:none">
      <span>üõãÔ∏è</span>
      <p>Sin √≠tems. Agrega una fila para comenzar.</p>
    </div>
  </div>

</div>

<div class="toast" id="toast"></div>

<script>
const tbody = document.getElementById('tbody');
let rowCount = 0;

const fmt = v => new Intl.NumberFormat('es-CL', { style: 'currency', currency: 'CLP', maximumFractionDigits: 0 }).format(v);

function addRow() {
  rowCount++;
  const tr = document.createElement('tr');
  tr.dataset.id = rowCount;

  tr.innerHTML = `
    <td><span class="row-num">‚Äî</span></td>
    <td style="min-width:280px"><input type="text" class="mat-name" placeholder="Ej: Sof√° 3 cuerpos"></td>
    <td><input type="number" class="unit-price" min="0" step="100" value="0" style="text-align:right"></td>
    <td style="text-align:center">
      <select class="qty-sel">
        ${[...Array(50)].map((_,i)=>`<option value="${i+1}"${i===0?' selected':''}>${i+1}</option>`).join('')}
      </select>
    </td>
    <td class="td-num"><input type="text" class="total-val" readonly></td>
    <td class="td-center"><button class="btn-del-row" onclick="deleteRow(this)">‚úï Eliminar</button></td>
  `;

  tr.addEventListener('input',  () => { calcRow(tr); calcAll(); });
  tr.addEventListener('change', () => { calcRow(tr); calcAll(); });

  tbody.appendChild(tr);
  renumber();
  calcRow(tr);
  calcAll();
  checkEmpty();
  tr.querySelector('.mat-name').focus();
  showToast('Fila agregada', 'success');
}

function deleteRow(btn) {
  const tr = btn.closest('tr');
  tr.style.transition = 'opacity 0.2s, transform 0.2s';
  tr.style.opacity = '0';
  tr.style.transform = 'translateX(12px)';
  setTimeout(() => { tr.remove(); renumber(); calcAll(); checkEmpty(); }, 200);
  showToast('Fila eliminada', 'info');
}

function renumber() {
  [...tbody.rows].forEach((row, i) => {
    row.querySelector('.row-num').textContent = String(i + 1).padStart(2, '0');
  });
}

function calcRow(tr) {
  const price = parseFloat(tr.querySelector('.unit-price').value) || 0;
  const qty   = parseInt(tr.querySelector('.qty-sel').value) || 1;
  const total = price * qty;
  tr.querySelector('.total-val').value = fmt(total);
  return total;
}

function calcAll() {
  let sum = 0;
  [...tbody.rows].forEach(tr => { sum += calcRow(tr); });
  document.getElementById('f-total').textContent = fmt(sum);
}

function checkEmpty() {
  const empty = tbody.rows.length === 0;
  document.getElementById('empty-state').style.display = empty ? 'block' : 'none';
  document.getElementById('tfoot').style.display = empty ? 'none' : '';
}

function resetTable() {
  if (tbody.rows.length > 0 && !confirm('¬øReiniciar la tabla? Se perder√°n todos los datos.')) return;
  tbody.innerHTML = '';
  rowCount = 0;
  calcAll();
  checkEmpty();
  showToast('Tabla reiniciada', 'info');
  for (let i = 0; i < 3; i++) setTimeout(() => addRow(), i * 60);
}

let toastTimer;
function showToast(msg, type = 'success') {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = `toast ${type}`;
  void t.offsetWidth;
  t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 2000);
}

checkEmpty();
resetTable();
</script>
</body>
</html>
